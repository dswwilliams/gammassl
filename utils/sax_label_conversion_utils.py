import torch as T

def convert_label_sax_to_cityscapes(label_img):
    """
    'Animal': 0,
    'Bench': 1,
    'Bicycle': 2,
    'Bin': 3,
    'Building': 4,
    'Bus': 5,
    'Bus Stop': 6,
    'Car': 7,
    'Construction': 8,
    'Ego_Car': 9,
    'Fence': 10,
    'Guard Rail': 11,
    'Lorry': 12,
    'Motorcycle': 13,
    'Pavement': 14,
    'Pedestrian': 15,
    'Pole': 16,
    'Post Box': 17,
    'Pushchair': 18,
    'RS_Water': 19,
    'Rider': 20,
    'Road': 21,
    'Sign': 22,
    'Sky': 23,
    'Taxi': 24,
    'Telephone Box': 25,
    'Terrain': 26,
    'Traffic Cone': 27,
    'Traffic Light': 28,
    'Van': 29,
    'Vegetation': 30,
    'Vehicle': 31,          # really this is utility vehicle, e.g. tractor etc. 
    'Void': 32,
    'Wall': 33,
    """
    sax2cityscapes = {
        0: 19,
        1: 19,
        2: 18,
        3: 19,
        4: 2,
        5: 15,
        6: 19,
        7: 13,
        8: 19,
        9: 19,
        10: 4,
        11: 19,
        12: 14,
        13: 17,
        14: 1,
        15: 11,
        16: 5,
        17: 19,
        18: 19,
        19: 19,
        20: 12,
        21: 0,
        22: 7,
        23: 10,
        24: 13,
        25: 19,
        26: 9,
        27: 19,
        28: 6,
        29: 13,
        30: 8,
        31: 19,
        32: 19,
        33: 3
        }
    h, w = label_img.shape
    index = T.tensor(list(sax2cityscapes.values()))
    label_img = T.gather(index.unsqueeze(0).expand(h,-1), 1, T.from_numpy(label_img).long())
    return label_img