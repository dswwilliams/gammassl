2024-01-09 20:22:45,635 INFO    MainThread:22904 [wandb_setup.py:_flush():76] Current SDK version is 0.15.2
2024-01-09 20:22:45,635 INFO    MainThread:22904 [wandb_setup.py:_flush():76] Configure stats pid to 22904
2024-01-09 20:22:45,635 INFO    MainThread:22904 [wandb_setup.py:_flush():76] Loading settings from /Users/dw/.config/wandb/settings
2024-01-09 20:22:45,635 INFO    MainThread:22904 [wandb_setup.py:_flush():76] Loading settings from /Users/dw/code/pytorch/gammassl_public/training/wandb/settings
2024-01-09 20:22:45,635 INFO    MainThread:22904 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-01-09 20:22:45,635 INFO    MainThread:22904 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-01-09 20:22:45,635 INFO    MainThread:22904 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'training/train.py', 'program': '/Users/dw/code/pytorch/gammassl_public/training/train.py'}
2024-01-09 20:22:45,636 INFO    MainThread:22904 [wandb_init.py:_log_setup():507] Logging user logs to /Users/dw/code/pytorch/gammassl_public/training/wandb/run-20240109_202245-9iwpttli/logs/debug.log
2024-01-09 20:22:45,636 INFO    MainThread:22904 [wandb_init.py:_log_setup():508] Logging internal logs to /Users/dw/code/pytorch/gammassl_public/training/wandb/run-20240109_202245-9iwpttli/logs/debug-internal.log
2024-01-09 20:22:45,636 INFO    MainThread:22904 [wandb_init.py:init():547] calling init triggers
2024-01-09 20:22:45,636 INFO    MainThread:22904 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {'gamma_reject_prop': 0.5, 'data_aug': 'candr', 'no_colour': False, 'use_sax_png_dataset': False, 'val_batch_size': None, 'bdd_raw_dataroot': '/Users/dw/data/bdd100k', 'train_on_bdd': False, 'val_on_bdd': False, 'bdd_val_dataroot': None, 'warmup_masking_num_its': 0, 'loss_c_masked_only': False, 'use_dinov1': False, 'dinov1_repo_path': '/Users/dw/code/pytorch/dino', 'dinov1_path': '/Users/dw/networks/dinov1.pth', 'ms_imgs_from_unmasked': True, 'mlp_dropout_prob': 0.0, 'attn_dropout_prob': 0.0, 'run_sup_task_only': False, 'no_random_seed': False, 'semihard_unmasked_prop': 0.5, 'use_semihard': False, 'masking_model_save_path': None, 'use_masking_model': False, 'use_soft_mask': False, 'use_gumbel_aug': False, 'mask_temp': 1, 'use_topk_aug': False, 'topk_prop': 0.5, 'use_topk': False, 'gumbel_temp': 1, 'use_gumbel': False, 'masking_net': 'cnn', 'w_masking_prob': 1, 'learned_masking_prob': 0.5, 'lr_masking': 0.0001, 'run_mask_learning_task': False, 'cu_loss': 'xent', 'w_fu': 1, 'w_c_cu': 1, 'w_c_ic': 1, 'optim_middle': False, 'mask_prob_total_iters': 125, 'get_new_mask_prob_every': 125, 'mask_prob_schedule': 'random', 'min_mask_prob': None, 'max_mask_prob': None, 'use_sigmoid_for_query_unmasked': True, 'soft_consistency_fn': 'xent', 'val_soft_consistency': False, 'mask_both': False, 'val_transforms': False, 'query_mask_region': 'uncertain', 'val_only_consistency': False, 'output_rank_metrics': False, 'val_with_sigmoid': True, 'val_temp': 1, 'query_mask_temp': 1, 'query_mask_scaling': None, 'kl_temp': 1, 'loss_c_temp': 1, 'gamma_temp': 1, 'gamma_scaling': None, 'no_mask_grads': False, 'mask_threshold': 0.9, 'use_sigmoid': True, 'adaptive_masking_p': 0.5, 'use_adaptive_masking': False, 'softmax_inference': True, 'loss_c_unmasked_only': False, 'proj_fu_features': False, 'use_feature_uniform_loss': False, 'use_m2f_xent': False, 'w_kl': 1, 'use_kl_uniform_loss': False, 'mask_only_query': True, 'wandb_project': 'gammassl', 'region_proposal_testing': False, 'run_sup_masking_training': False, 'frozen_target_save_path': None, 'frozen_target': False, 'proj_query_pup': False, 'enc_td_no_query_grad': False, 'td_no_query_grad': False, 'sharpen_temp': None, 'ema_update_every': 1, 'ema_beta': 0.999, 'use_ema_target_net': False, 'target_temp_factor': 0.1, 'use_symmetric_branches': False, 'validate_only': False, 'qual_validate': False, 'qual_output_dir': '/Users/dw/processed_results/qual_results', 'skip_uniformity': False, 'skip_projection': False, 'm2f_query_test': False, 'nheads': 4, 'num_points': 12544, 'run_sup_task': False, 'random_mask_prob': None, 'run_masking_task': False, 'use_scannet_twice': False, 'proto_seg_for_sup': False, 'imagenet_dataroot': '', 'scannet_dataroot': None, 'scannet': False, 'weird_dataroot': None, 'no_unlabelled': False, 'sunrgbd_dataroot': None, 'sunrgbd': False, 'val_all_sax': False, 'vit_size': 'small', 'n_train_segs': 4, 'n_val_segs': 4, 'use_wandb': True, 'train_vit': False, 'exp_name': None, 'lora_rank': None, 'dino_repo_path': '/Users/dw/code/pytorch/dinov2', 'dino_path': '/Users/dw/code/pytorch/gammassl/models/dinov2.pth', 'cityscapes_only': False, 'encoder': 'dino_repo_m2f', 'use_vit_adapter': False, 'decode_head': 'setr', 'use_dino': False, 'use_fake_data': False, 'use_fixed_random_init': False, 'model_config_path': '', 'model_weight_decay': 0, 'no_filtering': False, 'use_resize_noise': True, 'uniformity_kernel_size': 4, 'uniformity_stride': 4, 'include_void': True, 'max_uncertainty': 1, 'threshold_type': 'linear', 'num_thresholds': 500, 'lr': 0.0005, 'lr_backbone': None, 'warmup_ratio': None, 'n_warmup_iters': None, 'lr_policy': None, 'lr_mult': 1, 'decay_mult': 1, 'total_iters': 160000, 'w_c': 1, 'w_s': 1, 'w_gamma': 1, 'w_u': 1, 'w_p': 1, 'w_m': 1, 'w_mask': 1, 'w_dice': 1, 'w_ce': 1, 'method': 'gammassl', 'batch_size': 24, 'n_epochs': 1000, 'use_class_weights_ssl': False, 'use_class_weights_sup': False, 'no_transforms': False, 'overfit_on_batch': False, 'feature_len': None, 'prototype_len': 256, 'intermediate_dim': 256, 'feature_df': 4, 'cityscapes_dataroot': '/Users/dw/data/', 'wilddash_dataroot': '/Users/dw/data/wilddash', 'sax_raw_dataroot': '/Users/dw/data/sax_raw', 'unlabelled_dataroot': '/Users/dw/data/bdd100k', 'sax_labelled_dataroot': '/Users/dw/data/sax_labelled', 'sensor_models_path': '/Users/dw/code/lut/sensor-models', 'cityscapes_class_weights_path': '/Volumes/scratchdata/dw/cityscapes_class_weights_19c.pkl', 'benchmarks_results_dir': '/Volumes/scratchdata/dw/project_sax_results_tau_eq_1/results', 'sax_domain': 'london', 'min_crop_ratio': 2, 'max_crop_ratio': 3, 'big_crop_size': 208, 'device': 'cpu', 'use_cpu': True, 'gpu_no': '0', 'num_workers': 0, 'use_deep_features': True, 'seg_net_config_path': None, 'use_imagenet_norm': True, 'imagenet_save_path': None, 'temperature': 0.07, 'log_dir': None, 'log_every': 1, 'visdom_port': 8097, 'output2visdom': False, 'full_validation_every': 125, 'skip_validation': True, 'save_every': 1, 'network_destination': None, 'save_path': None, 'prototypes_path': None}
2024-01-09 20:22:45,637 INFO    MainThread:22904 [wandb_init.py:init():596] starting backend
2024-01-09 20:22:45,637 INFO    MainThread:22904 [wandb_init.py:init():600] setting up manager
2024-01-09 20:22:45,640 INFO    MainThread:22904 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2024-01-09 20:22:45,645 INFO    MainThread:22904 [wandb_init.py:init():606] backend started and connected
2024-01-09 20:22:45,680 INFO    MainThread:22904 [wandb_init.py:init():700] updated telemetry
2024-01-09 20:22:45,770 INFO    MainThread:22904 [wandb_init.py:init():737] communicating run to backend with 60.0 second timeout
2024-01-09 20:22:46,244 INFO    MainThread:22904 [wandb_run.py:_on_init():2177] communicating current version
2024-01-09 20:22:46,335 INFO    MainThread:22904 [wandb_run.py:_on_init():2186] got version response upgrade_message: "wandb version 0.16.1 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-01-09 20:22:46,335 INFO    MainThread:22904 [wandb_init.py:init():787] starting run threads in backend
2024-01-09 20:22:53,881 INFO    MainThread:22904 [wandb_run.py:_console_start():2158] atexit reg
2024-01-09 20:22:53,881 INFO    MainThread:22904 [wandb_run.py:_redirect():2013] redirect: SettingsConsole.WRAP_RAW
2024-01-09 20:22:53,882 INFO    MainThread:22904 [wandb_run.py:_redirect():2078] Wrapping output streams.
2024-01-09 20:22:53,882 INFO    MainThread:22904 [wandb_run.py:_redirect():2103] Redirects installed.
2024-01-09 20:22:53,882 INFO    MainThread:22904 [wandb_init.py:init():829] run started, returning control to user process
2024-01-09 20:24:23,574 WARNING MsgRouterThr:22904 [router.py:message_loop():77] message_loop has been closed
